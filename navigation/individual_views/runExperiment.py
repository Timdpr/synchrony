"""
Runs the experiment with given parameters and outputs results as a text file

@author tp275
"""
import RIDF
from quiverPlot import quiver_plot, get_rsync_and_rotation
import numpy as np
from individualTests import TestPatternsOnNetwork

import time
start_time = time.time()

def outputResultsTextFile(results, result_num):
    with open('results%i.txt'%(result_num), 'w') as f:
    	f.write(str(results))
        

test = TestPatternsOnNetwork([7, 90], 5, rotation=True, rot_step=2,
                             pattern_dir='/home/ec2-user/environment/synchrony/images/exp_rotation_plants/',
                             route_pattern_dir='/home/ec2-user/environment/synchrony/images/routes/route_plants_90x7/',
#                             pattern_dir='/mnt/hgfs/Masters/Project/synchrony/images/exp_rotation_rsync/',
#                             route_pattern_dir='/mnt/hgfs/Masters/Project/synchrony/images/routes/route_boxes_90x7/',
                             pattern_b=0, pattern_c=0.2, conn_b_bck=1, conn_c_bck=0.3,
                             conn_b=1, conn_c=0.15, downsample=100)

#results = test.run()
results = [[[[0.9472049689440993, 0.34724740465686277], [0.9099378881987578, 0.427093530136529], [0.8571428571428571, 0.35154328557569176], [0.8074534161490683, 0.49401677752122614], [0.7608695652173914, 0.37431756876690164], [0.7422360248447205, 0.3596796383801674], [0.7391304347826086, 0.38858387610677514], [0.7391304347826086, 0.41102162730666586], [0.7453416149068323, 0.4016971832625019], [0.7484472049689441, 0.3545999923212481], [0.7204968944099379, 0.3583495075259436], [0.6832298136645962, 0.3461305034678253], [0.6428571428571429, 0.30657057943257854], [0.5993788819875776, 0.2755820880327304], [0.5683229813664596, 0.22995317548382718], [0.546583850931677, 0.20858420322683965], [0.5434782608695652, 0.15264956797016452], [0.5403726708074534, 0.11968271878397503], [0.5403726708074534, 0.09989577098963605], [0.546583850931677, 0.06882496813001501], [0.5559006211180124, 0.053642816460350434], [0.546583850931677, 0.06101430300610813], [0.5403726708074534, 0.09521017796816642], [0.5372670807453416, 0.07053472917061862], [0.5559006211180124, 0.08375562775901332], [0.5745341614906833, 0.05376748225826842], [0.5745341614906833, 0.04772714943538187], [0.6024844720496895, 0.06799157131346352], [0.6304347826086957, 0.11089219597587414], [0.6459627329192547, 0.12195278749670749], [0.6770186335403726, 0.1796619652926176], [0.7080745341614907, 0.13430468073376903], [0.7204968944099379, 0.14763234093843117], [0.7298136645962733, 0.13068719956996977], [0.7546583850931677, 0.14712249174165865], [0.782608695652174, 0.1925004571009114], [0.8074534161490683, 0.20466473125079876], [0.8260869565217391, 0.29058986532791414], [0.8322981366459627, 0.3550624780606546], [0.84472049689441, 0.30386984637137054], [0.8540372670807453, 0.24874775434140117], [0.8540372670807453, 0.23981089435153563], [0.8788819875776398, 0.3070174816438364], [0.9037267080745341, 0.2852143937944504], [0.9440993788819876, 0.5726429333691121]], [[0.8835820895522388, 0.3735429119361144], [0.8746268656716418, 0.2909568431968388], [0.844776119402985, 0.46663282209081525], [0.8149253731343283, 0.6029465561260375], [0.7880597014925373, 0.3505701298039923], [0.7820895522388059, 0.3976867603498425], [0.7820895522388059, 0.36327122881420915], [0.7701492537313432, 0.3939290576410202], [0.7492537313432835, 0.38187372093855415], [0.7343283582089553, 0.38828526179439266], [0.7044776119402985, 0.3501958125944163], [0.6686567164179105, 0.36166386298417375], [0.6388059701492538, 0.3412358253118198], [0.6179104477611941, 0.3057971304223654], [0.5880597014925373, 0.2334380020469105], [0.564179104477612, 0.23183467203681085], [0.5582089552238806, 0.17980455474269713], [0.5462686567164179, 0.16624774643437537], [0.5462686567164179, 0.12859124387219503], [0.5462686567164179, 0.10212167498797649], [0.5253731343283582, 0.07930198105431535], [0.5074626865671642, 0.04190937714164536], [0.49850746268656715, 0.037345269387578865], [0.5164179104477612, 0.06300068044638919], [0.5373134328358209, 0.03737048160254609], [0.5671641791044776, 0.07884145426113329], [0.5761194029850746, 0.0873727822053102], [0.591044776119403, 0.08666789411203558], [0.608955223880597, 0.09197681947352238], [0.6298507462686567, 0.133333831104452], [0.6477611940298508, 0.1330226673257205], [0.6865671641791045, 0.1867093324920425], [0.7014925373134329, 0.1720770005386319], [0.7074626865671642, 0.1364726091086455], [0.7194029850746269, 0.11573406511970237], [0.755223880597015, 0.15767080215622292], [0.7850746268656716, 0.2586740513733754], [0.8238805970149253, 0.2431514116957996], [0.8477611940298507, 0.25057281693403505], [0.8746268656716418, 0.32694850592561786], [0.8835820895522388, 0.26461930396785927], [0.8865671641791045, 0.2613837407697105], [0.8985074626865671, 0.28811344257619176], [0.9104477611940298, 0.374365558130005], [0.8985074626865671, 0.3061703292627781]]], [[[0.9472049689440993, 0.5942820116495228], [0.9099378881987578, 0.5834629812041899], [0.8571428571428571, 0.5037033542332742], [0.8074534161490683, 0.3858449279703658], [0.7608695652173914, 0.5352282375601483], [0.7422360248447205, 0.4598041295538853], [0.7391304347826086, 0.41738523904296426], [0.7391304347826086, 0.44818338750725367], [0.7453416149068323, 0.42075869042638664], [0.7484472049689441, 0.3998848725316574], [0.7204968944099379, 0.35516500501496545], [0.6832298136645962, 0.365496762975884], [0.6428571428571429, 0.3208905159371817], [0.5993788819875776, 0.25825019215536854], [0.5683229813664596, 0.22560447251669336], [0.546583850931677, 0.16335916491056704], [0.5434782608695652, 0.15515029669502384], [0.5403726708074534, 0.11830048030492187], [0.5403726708074534, 0.09263210181442137], [0.546583850931677, 0.10323532891343384], [0.5559006211180124, 0.07202354350363625], [0.546583850931677, 0.07291133282672319], [0.5403726708074534, 0.095575387102152], [0.5372670807453416, 0.09656884309982004], [0.5559006211180124, 0.0879027525610785], [0.5745341614906833, 0.07762775816922023], [0.5745341614906833, 0.09264161883683146], [0.6024844720496895, 0.06595807869376547], [0.6304347826086957, 0.10375560993933776], [0.6459627329192547, 0.09698671394869178], [0.6770186335403726, 0.09440032427809465], [0.7080745341614907, 0.0892590606907682], [0.7204968944099379, 0.10463297271832149], [0.7298136645962733, 0.2944828809875825], [0.7546583850931677, 0.2441129281894193], [0.782608695652174, 0.1899347487272983], [0.8074534161490683, 0.24830765574476077], [0.8260869565217391, 0.22473430153604598], [0.8322981366459627, 0.23175608123043903], [0.84472049689441, 0.30792637137184836], [0.8540372670807453, 0.28700074102769196], [0.8540372670807453, 0.2116122278858166], [0.8788819875776398, 0.25483837385996877], [0.9037267080745341, 0.27653539319578546], [0.9440993788819876, 0.3099213336028521]], [[0.8835820895522388, 0.30348048798140725], [0.8746268656716418, 0.3157001243367378], [0.844776119402985, 0.3028850508000218], [0.8149253731343283, 0.5890296673070791], [0.7880597014925373, 0.5325018345548765], [0.7820895522388059, 0.46415352124803805], [0.7820895522388059, 0.45202754540838935], [0.7701492537313432, 0.3793917819643402], [0.7492537313432835, 0.44093683599294475], [0.7343283582089553, 0.38506494121366164], [0.7044776119402985, 0.3913561109951241], [0.6686567164179105, 0.3574331330907138], [0.6388059701492538, 0.3290133825615857], [0.6179104477611941, 0.31171515345964457], [0.5880597014925373, 0.2563181927539346], [0.564179104477612, 0.22075819048511128], [0.5582089552238806, 0.20801302491969748], [0.5462686567164179, 0.1733533347867118], [0.5462686567164179, 0.13343458367156305], [0.5462686567164179, 0.1082367536009914], [0.5253731343283582, 0.0840472187606543], [0.5074626865671642, 0.08613055189485642], [0.49850746268656715, 0.05013338880484691], [0.5164179104477612, 0.062239500017301], [0.5373134328358209, 0.10934795260499294], [0.5671641791044776, 0.08825327877197502], [0.5761194029850746, 0.09053533383621103], [0.591044776119403, 0.07264609840904031], [0.608955223880597, 0.11489701359880677], [0.6298507462686567, 0.11113417643935794], [0.6477611940298508, 0.13713292372395808], [0.6865671641791045, 0.09114707470044646], [0.7014925373134329, 0.12209706130107263], [0.7074626865671642, 0.23165590261497251], [0.7194029850746269, 0.2006744642446346], [0.755223880597015, 0.1911633275693511], [0.7850746268656716, 0.2990819040783609], [0.8238805970149253, 0.2942191166186673], [0.8477611940298507, 0.22778889480139528], [0.8746268656716418, 0.2752758529517531], [0.8835820895522388, 0.2628494726622033], [0.8865671641791045, 0.4462123259573824], [0.8985074626865671, 0.2761712171699432], [0.9104477611940298, 0.2542725345205787], [0.8985074626865671, 0.3124830786064053]]], [[[0.9472049689440993, 0.33950988657321546], [0.9099378881987578, 0.37538951213303173], [0.8571428571428571, 0.3361640389862421], [0.8074534161490683, 0.34362268702105125], [0.7608695652173914, 0.33120559081692513], [0.7422360248447205, 0.3757695806430828], [0.7391304347826086, 0.4476723739040919], [0.7391304347826086, 0.43824931950749013], [0.7453416149068323, 0.4541000225865955], [0.7484472049689441, 0.3756828651131279], [0.7204968944099379, 0.36327663364639956], [0.6832298136645962, 0.36960145854347226], [0.6428571428571429, 0.30200883716117105], [0.5993788819875776, 0.2641689837361538], [0.5683229813664596, 0.25535982916202155], [0.546583850931677, 0.19006079944238413], [0.5434782608695652, 0.1638437911023718], [0.5403726708074534, 0.09504673940601067], [0.5403726708074534, 0.07421775831963354], [0.546583850931677, 0.08046368061796866], [0.5559006211180124, 0.0555297587208903], [0.546583850931677, 0.050831058482714325], [0.5403726708074534, 0.11194074321425526], [0.5372670807453416, 0.08862060987499965], [0.5559006211180124, 0.10009713175412872], [0.5745341614906833, 0.10541448811152562], [0.5745341614906833, 0.08304667434214918], [0.6024844720496895, 0.14057539284844722], [0.6304347826086957, 0.0983087294121682], [0.6459627329192547, 0.12601466070940065], [0.6770186335403726, 0.14493462561573564], [0.7080745341614907, 0.25284814067192957], [0.7204968944099379, 0.15275785880002815], [0.7298136645962733, 0.21717327830982078], [0.7546583850931677, 0.26184614487195756], [0.782608695652174, 0.1369899277429667], [0.8074534161490683, 0.3078219867786926], [0.8260869565217391, 0.3193161978726007], [0.8322981366459627, 0.2164293858862737], [0.84472049689441, 0.3553192565014861], [0.8540372670807453, 0.30111450133457474], [0.8540372670807453, 0.2427981992370341], [0.8788819875776398, 0.2452178540275059], [0.9037267080745341, 0.25694180793205706], [0.9440993788819876, 0.5085124301968038]], [[0.8835820895522388, 0.4853963429172279], [0.8746268656716418, 0.5626697781658414], [0.844776119402985, 0.515561330072271], [0.8149253731343283, 0.33468603565162747], [0.7880597014925373, 0.4210125403657708], [0.7820895522388059, 0.35442392367497316], [0.7820895522388059, 0.36155864204700294], [0.7701492537313432, 0.3964496448885119], [0.7492537313432835, 0.3983401510636909], [0.7343283582089553, 0.4095819592382489], [0.7044776119402985, 0.35222254568568895], [0.6686567164179105, 0.35096887093384005], [0.6388059701492538, 0.3434599056222803], [0.6179104477611941, 0.32246672418132183], [0.5880597014925373, 0.2624652426712037], [0.564179104477612, 0.23470763955471938], [0.5582089552238806, 0.22263503839099755], [0.5462686567164179, 0.1453529661108095], [0.5462686567164179, 0.14193769659466393], [0.5462686567164179, 0.09930706663648844], [0.5253731343283582, 0.10287495095370038], [0.5074626865671642, 0.08718992885358937], [0.49850746268656715, 0.0789584720630003], [0.5164179104477612, 0.06935617229135836], [0.5373134328358209, 0.09412844643957362], [0.5671641791044776, 0.08683222082411647], [0.5761194029850746, 0.10898074726032012], [0.591044776119403, 0.13424206322037863], [0.608955223880597, 0.11528704401821244], [0.6298507462686567, 0.14804180067029005], [0.6477611940298508, 0.1687515298160751], [0.6865671641791045, 0.20350184313335998], [0.7014925373134329, 0.2161358958423685], [0.7074626865671642, 0.2579318001753575], [0.7194029850746269, 0.26070692894395786], [0.755223880597015, 0.2033734704654318], [0.7850746268656716, 0.26585325250096237], [0.8238805970149253, 0.2901030515188208], [0.8477611940298507, 0.24493753941557814], [0.8746268656716418, 0.2808082354806154], [0.8835820895522388, 0.2549464213298221], [0.8865671641791045, 0.2601437200590185], [0.8985074626865671, 0.2552318996390142], [0.9104477611940298, 0.25384068209929495], [0.8985074626865671, 0.5820446450535004]]], [[[0.9472049689440993, 0.6185392069457072], [0.9099378881987578, 0.4191144358403253], [0.8571428571428571, 0.4439029952496601], [0.8074534161490683, 0.6056239945707509], [0.7608695652173914, 0.4688016052516607], [0.7422360248447205, 0.4796926738669083], [0.7391304347826086, 0.4812962635671125], [0.7391304347826086, 0.43520975081032065], [0.7453416149068323, 0.3981905446540124], [0.7484472049689441, 0.40111265505707283], [0.7204968944099379, 0.3734115173086602], [0.6832298136645962, 0.33910512296090484], [0.6428571428571429, 0.29787222364415034], [0.5993788819875776, 0.25205277636890905], [0.5683229813664596, 0.2226218033444346], [0.546583850931677, 0.18182073161781778], [0.5434782608695652, 0.12158072920569266], [0.5403726708074534, 0.11629343998077626], [0.5403726708074534, 0.07259394321421421], [0.546583850931677, 0.0664512760906008], [0.5559006211180124, 0.041735655232284105], [0.546583850931677, 0.055811650755206006], [0.5403726708074534, 0.09272854099018916], [0.5372670807453416, 0.12057664536411251], [0.5559006211180124, 0.0611367454450189], [0.5745341614906833, 0.0597207477607393], [0.5745341614906833, 0.07575044616048227], [0.6024844720496895, 0.09091330833084899], [0.6304347826086957, 0.09741066711972733], [0.6459627329192547, 0.09172069244987352], [0.6770186335403726, 0.1135357145451232], [0.7080745341614907, 0.0886066234004098], [0.7204968944099379, 0.0971140008245003], [0.7298136645962733, 0.27234341250259486], [0.7546583850931677, 0.20568594641095342], [0.782608695652174, 0.20486557997218388], [0.8074534161490683, 0.239392155149839], [0.8260869565217391, 0.21158672184791955], [0.8322981366459627, 0.2412629047368281], [0.84472049689441, 0.3270687586189049], [0.8540372670807453, 0.2433547522280048], [0.8540372670807453, 0.24005165565205902], [0.8788819875776398, 0.23233739465047168], [0.9037267080745341, 0.43966120992182267], [0.9440993788819876, 0.47169017424636084]], [[0.8835820895522388, 0.2975219105688319], [0.8746268656716418, 0.3235512088944806], [0.844776119402985, 0.6296680078803231], [0.8149253731343283, 0.39573105944664067], [0.7880597014925373, 0.45330261339804373], [0.7820895522388059, 0.4595846393507129], [0.7820895522388059, 0.41260101639858277], [0.7701492537313432, 0.4225577537063638], [0.7492537313432835, 0.44968338840764854], [0.7343283582089553, 0.38420807720668637], [0.7044776119402985, 0.35824766454476614], [0.6686567164179105, 0.3684114435311975], [0.6388059701492538, 0.3202132624685731], [0.6179104477611941, 0.2960186441307731], [0.5880597014925373, 0.26627451504350347], [0.564179104477612, 0.2254923567628526], [0.5582089552238806, 0.18690167465087237], [0.5462686567164179, 0.17411055496529126], [0.5462686567164179, 0.1387327833513221], [0.5462686567164179, 0.07801872326535138], [0.5253731343283582, 0.08718139711441238], [0.5074626865671642, 0.03283414226718078], [0.49850746268656715, 0.06649082484989859], [0.5164179104477612, 0.06394038740195714], [0.5373134328358209, 0.05756733171928853], [0.5671641791044776, 0.06849780232420552], [0.5761194029850746, 0.07410977946934409], [0.591044776119403, 0.1235636266696349], [0.608955223880597, 0.07637630880466606], [0.6298507462686567, 0.10304390764197956], [0.6477611940298508, 0.129114323091583], [0.6865671641791045, 0.15508362208203158], [0.7014925373134329, 0.11544220238350594], [0.7074626865671642, 0.11490578425583772], [0.7194029850746269, 0.11626752200205187], [0.755223880597015, 0.1300458469248275], [0.7850746268656716, 0.19399935088460998], [0.8238805970149253, 0.21574590938684712], [0.8477611940298507, 0.20764243060099016], [0.8746268656716418, 0.292149568370259], [0.8835820895522388, 0.2682448657036085], [0.8865671641791045, 0.25315663476523476], [0.8985074626865671, 0.28235110410426234], [0.9104477611940298, 0.2837430746592766], [0.8985074626865671, 0.368605188578661]]], [[[0.9472049689440993, 0.37824656590348027], [0.9099378881987578, 0.2758175045400009], [0.8571428571428571, 0.3042100502433643], [0.8074534161490683, 0.5113874967512277], [0.7608695652173914, 0.31689119290271733], [0.7422360248447205, 0.35767314412271245], [0.7391304347826086, 0.46383326503785066], [0.7391304347826086, 0.4196645109864966], [0.7453416149068323, 0.3693471069281607], [0.7484472049689441, 0.3852878992359723], [0.7204968944099379, 0.3592788743952187], [0.6832298136645962, 0.3240743871528875], [0.6428571428571429, 0.29018310450167284], [0.5993788819875776, 0.2639122863668425], [0.5683229813664596, 0.22470813154490465], [0.546583850931677, 0.1908583382058163], [0.5434782608695652, 0.1340548200027743], [0.5403726708074534, 0.1660854494415897], [0.5403726708074534, 0.08939615125912945], [0.546583850931677, 0.06800386394680999], [0.5559006211180124, 0.08841789194607531], [0.546583850931677, 0.07660836916385595], [0.5403726708074534, 0.06870513148644382], [0.5372670807453416, 0.08184920463498127], [0.5559006211180124, 0.07610811934397423], [0.5745341614906833, 0.09313721036312511], [0.5745341614906833, 0.16910425835662135], [0.6024844720496895, 0.13436850517507978], [0.6304347826086957, 0.10098740188541433], [0.6459627329192547, 0.10289376546157461], [0.6770186335403726, 0.13532535153673392], [0.7080745341614907, 0.11364094650541433], [0.7204968944099379, 0.18241039383952493], [0.7298136645962733, 0.25236657499698945], [0.7546583850931677, 0.2665783778577263], [0.782608695652174, 0.1480794307692059], [0.8074534161490683, 0.1969736130175385], [0.8260869565217391, 0.20910158233544535], [0.8322981366459627, 0.2789896055880623], [0.84472049689441, 0.2727148888591762], [0.8540372670807453, 0.23470755978416052], [0.8540372670807453, 0.24675849201794303], [0.8788819875776398, 0.24040224169827062], [0.9037267080745341, 0.2661745757665595], [0.9440993788819876, 0.5403360325222811]], [[0.8835820895522388, 0.5568952704412576], [0.8746268656716418, 0.5173537006279244], [0.844776119402985, 0.3693320913884218], [0.8149253731343283, 0.3247442483011214], [0.7880597014925373, 0.3165876280456159], [0.7820895522388059, 0.48176624736009127], [0.7820895522388059, 0.35966649338005674], [0.7701492537313432, 0.3551144352923226], [0.7492537313432835, 0.39083454135861334], [0.7343283582089553, 0.45505290665541603], [0.7044776119402985, 0.3896492736930978], [0.6686567164179105, 0.33083501828846945], [0.6388059701492538, 0.30558912418165657], [0.6179104477611941, 0.29106881815218266], [0.5880597014925373, 0.2228867736835981], [0.564179104477612, 0.22259753446310812], [0.5582089552238806, 0.1926209159840987], [0.5462686567164179, 0.15424079983012356], [0.5462686567164179, 0.11214358026915273], [0.5462686567164179, 0.10954732302632532], [0.5253731343283582, 0.0355791962048632], [0.5074626865671642, 0.04432912564430949], [0.49850746268656715, 0.055911894921826834], [0.5164179104477612, 0.05325212992878268], [0.5373134328358209, 0.05908026529542517], [0.5671641791044776, 0.0902113739648603], [0.5761194029850746, 0.09672260361982257], [0.591044776119403, 0.12252057469947901], [0.608955223880597, 0.12036911708088256], [0.6298507462686567, 0.18805119093144274], [0.6477611940298508, 0.24003335063579617], [0.6865671641791045, 0.12400746013852636], [0.7014925373134329, 0.13110027011276243], [0.7074626865671642, 0.11945392385855737], [0.7194029850746269, 0.32706847250111565], [0.755223880597015, 0.15630313224560055], [0.7850746268656716, 0.31845236784268793], [0.8238805970149253, 0.31616630513191335], [0.8477611940298507, 0.3194051761740708], [0.8746268656716418, 0.3814849024751351], [0.8835820895522388, 0.36019288050131115], [0.8865671641791045, 0.25529425608101225], [0.8985074626865671, 0.24237822735469053], [0.9104477611940298, 0.44276773216283055], [0.8985074626865671, 0.5549162811771098]]]]
print("--- %s seconds ---" % (time.time() - start_time))
patterns = test.patterns

"""
i = 0
original_image = RIDF.getImageList(patterns[:,:,test.rotations_per_image*i:(test.rotations_per_image*i)+test.rotations_per_image])[0]

for i in range(6):  # for i = image number
    # Plot RIDF graph (of each rotated image), for each image
    RIDF.plotRIDF(patterns[:,:,test.rotations_per_image*i:(test.rotations_per_image*i)+test.rotations_per_image], i,
                  use_single_comparison=True, original_image=original_image)
"""

#rsyncs = np.zeros((17, 29))
#rsync_test = []
#degrees = [180 for i in range(493)]
#degrees_test = []


for i in range(3):  # for i = image number
    # Create list of results of each sample for the particular image
    results_by_image = [sample[i] for sample in results]
    RIDF.plotRotationSynchrony(results_by_image, i)
#    rsync, degree = get_rsync_and_rotation(results_by_image)
#    degrees.append(degree)
#    degrees_test.append(degree)
#    rsync_test.append(rsync)

    
#rsyncs[6][7] = rsync_test[0]
#degrees[123] = -(degrees_test[0])

missing_img_nums = [slice(37, 42), slice(46, 50), slice(52, 59), slice(61, 76), slice(78, 93),
                    slice(95, 110), slice(112, 125), slice(130, 140),slice(147, 153), slice(165, 170),
                    slice(182, 185), slice(222, 226), slice(238, 244), slice(255, 261), slice(272, 279),
                    slice(289, 296), slice(306, 313), slice(323, 330), slice(334, 339), slice(340, 347),
                    slice(348, 356), slice(358, 362), slice(365, 374), slice(382, 391), slice(399, 408),
                    slice(417, 425), slice(434, 442), slice(451, 458), slice(469, 473)]
#quiver_plot(degrees, rsyncs, missing_img_nums)
    
outputResultsTextFile(results, 1)
